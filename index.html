<!DOCTYPE html>
<html lang="en">
<head>
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>SZAG InfoTV</title>
<link rel="icon" type="image/x-icon" href="favicon.png">
<script type="text/javascript" src="https://livejs.com/live.js"></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-CXT37WPC0Y"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-CXT37WPC0Y');
</script>

<style>
body {
    font-family: Verdana, sans-serif;
    padding: 0;
    margin: 0;
    background-color: black;
}

.mySlides {
    display: none;
    position: absolute;
    width: 100%;
    height: 100%;
    top: 0;
    left: 0;
    border: none;
    padding: 0;
    margin: 0;
    align-content: center;
}

img, embed { vertical-align: middle; }

.slideshow-container {
    max-width: 100%;
    position: center;
    margin: 0px;
}

#alttextsize {
    font-size: 40px;
    font-weight: bold;
    color: #000;
}

/*Tűzriadó */
#overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background-color: rgba(0,0,0,0.8);
  z-index: 10000;
  display: none;
  justify-content: center;
  align-items: center;
}
#overlay img {
  max-width: 100%;
  max-height: 100%;
}
</style>
</head>

<body>
<!-- TŰZRIADÓ -->
  <div id="overlay">
    <img id="alertImage" src="" alt="Tűzriadó">
  </div>

<div class="mySlides" id="helyettesites">
    <div style="position: relative; width: 100%; height: 0; padding-top: 56.2500%;
 padding-bottom: 0; margin-top: 0; margin-bottom: 0; overflow: hidden;
 border-radius: 8px; will-change: transform;">
    <iframe loading="lazy" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0;margin: 0;"
    src="https:&#x2F;&#x2F;www.canva.com&#x2F;design&#x2F;DAFzhI98FxY&#x2F;ZB_Z3bO34ENHNTBBNbbLZA&#x2F;view?embed">
    </iframe>
    </div>
    
<div class="mySlides" id="aktualis_image_container">
    <img id="aktualis_image" src="" style="width:100%" alt="Aktuális közlemény">
</div>

<div class="mySlides" id="lunch_image_container">
    <img id="lunch_image" src="" style="width:100%" alt="Ebéd">
</div>

<div class="mySlides" id="honapverse_image_container">
    <img id="honapverse_image" src="" style="width:100%" alt="A hónap verse">
</div>

<div class="mySlides" id="futar">
    <iframe type="text/html" src="https://futar.sznokarecords.com/?stopID=BKK_F03329" style="position: absolute; width: 100%; height: 100%; top: 0; left: 0; border: none; padding: 0;" alt="BKK FUTÁR" title="BKK FUTÁR">
</iframe>
</div>
    
<div class="mySlides" id="p1_image_container">
    <img id="p1_image" src="" style="width:100%" alt="1">
</div>
    
<div class="mySlides" id="p2_image_container">
    <img id="p2_image" src="" style="width:100%" alt="2">
</div>
    
</div>

<div style="text-align:center">
  <span class="dot"></span> 
  <span class="dot"></span> 
  <span class="dot"></span> 
  <span class="dot"></span> 
  <span class="dot"></span> 
  <span class="dot"></span> 
  <span class="dot"></span> 
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
let slides = [
    {
        elementId: "aktualis_image",
        containerId: "aktualis_image_container",
        schedules: [
            { startDate: "2024-08-19", endDate: "2024-09-12", url: "img/e0521.png" }
        ]
    },
    {
        elementId: "lunch_image",
        containerId: "lunch_image_container",
        schedules: [
            { startDate: "2024-05-21", endDate: "2024-05-21", url: "img/e0521.png" },
            { startDate: "2024-05-22", endDate: "2024-05-22", url: "img/e0522.png" }
        ]
    },
    {
        elementId: "honapverse_image",
        containerId: "honapverse_image_container",
        schedules: [
            { startDate: "2024-05-25", endDate: "2024-05-31", url: "img/hvmajus.png" },
            { startDate: "2024-06-01", endDate: "2024-06-07", url: "img/evverseszav.png" }
        ]
    },
        {
        elementId: "p1_image",
        containerId: "p2_image_container",
        schedules: [
            { startDate: "2024-01-01", endDate: "2024-01-01", url: "img/hvmajus.png" }
        ]
    },
        {
    elementId: "p1_image",
    containerId: "p2_image_container",
    schedules: [
        { startDate: "2024-05-25", endDate: "2024-05-31", url: "img/hvmajus.png" }
    ]
}
];

// Get today's date in YYYY-MM-DD format
var today = new Date().toISOString().split('T')[0];

// Set the images based on today's date
slides.forEach(slide => {
    let currentSchedule = slide.schedules.find(schedule => today >= schedule.startDate && today <= schedule.endDate);
    if (currentSchedule) {
        document.getElementById(slide.elementId).src = currentSchedule.url;
    } else {
        // Remove the slide from the DOM if there's no valid schedule for today
        let container = document.getElementById(slide.containerId);
        if (container) {
            container.parentNode.removeChild(container);
        }
    }
});

// Slide show functionality
let slideIndex = 0;
showSlides(slideIndex);

function showSlides(n) {
    let i;
    let slides = document.getElementsByClassName("mySlides");
    let dots = document.getElementsByClassName("dot");
    if (n >= slides.length) {slideIndex = 0}
    if (n < 0) {slideIndex = slides.length - 1}
    for (i = 0; i < slides.length; i++) {
        slides[i].style.display = "none";  
    }
    for (i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.replace(" active", "");
    }
    slides[slideIndex].style.display = "block";  
    dots[slideIndex].className += " active";
}
    
//Lapozás

function showSlides() {
    let i;
    let slides = document.getElementsByClassName("mySlides");
    let dots = document.getElementsByClassName("dot");
    for (i = 0; i < slides.length; i++) {
        slides[i].style.display = "none";  
    }
    slideIndex++;
    if (slideIndex > slides.length) {slideIndex = 1}    
    for (i = 0; i < dots.length; i++) {
        dots[i].className = dots[i].className.replace(" active", "");
    }
    slides[slideIndex-1].style.display = "block";  
    dots[slideIndex-1].className += " active";
    setTimeout(showSlides, 2000); // Change image every 20 seconds
}

//
function changeSlide(n) {
    showSlides(slideIndex += n);
}

// Listen for arrow key presses
document.addEventListener('keydown', function(event) {
    if(event.key === 'ArrowLeft') {
        changeSlide(-1);
    } else if(event.key === 'ArrowRight') {
        changeSlide(1);
    }
});

// Refresh the page at specific times
function refreshAt(hours, minutes, seconds) {
    var now = new Date();
    var then = new Date();
    if(now.getHours() > hours || (now.getHours() == hours && now.getMinutes() > minutes) || now.getHours() == hours && now.getMinutes() == minutes && now.getSeconds() >= seconds) {
        then.setDate(now.getDate() + 1);
    }
    then.setHours(hours);
    then.setMinutes(minutes);
    then.setSeconds(seconds);
    
    var timeout = (then.getTime() - now.getTime());
    setTimeout(function() { window.location.reload(true); }, timeout);
}

refreshAt(06,25,56);
refreshAt(06,55,56);
refreshAt(07,25,56);
refreshAt(07,40,56);
refreshAt(07,55,56);
refreshAt(08,05,56);
refreshAt(08,20,56);
refreshAt(08,35,56);
refreshAt(09,05,56);
refreshAt(09,20,56);
refreshAt(09,35,56);
refreshAt(10,05,56);
refreshAt(10,20,56);
refreshAt(10,35,56);
refreshAt(11,05,56);
refreshAt(11,20,56);
refreshAt(11,35,56);
refreshAt(12,05,56);
refreshAt(12,20,56);
refreshAt(12,35,56);
refreshAt(13,05,56);
refreshAt(13,20,56);
refreshAt(13,35,56);
refreshAt(14,05,56);
refreshAt(14,20,56);
refreshAt(14,35,56);
refreshAt(15,05,56);
refreshAt(15,20,56);
refreshAt(15,35,56);
refreshAt(16,05,56);
refreshAt(16,20,56);
refreshAt(17,05,56);
refreshAt(17,20,56);
refreshAt(18,05,56);
refreshAt(18,20,56);
refreshAt(19,00,56);
refreshAt(19,20,56);
// Add more refresh times as needed...

// Fullscreen on click
addEventListener("click", function() {
    var el = document.documentElement;
    var rfs = el.requestFullScreen || el.webkitRequestFullScreen || el.mozRequestFullScreen;
    rfs.call(el);
});

// Tűzriadó státusz lekérdezés
function checkStatus() {
  var apiKey = 'AIzaSyA_TI50_1jgH6EmFYJy_HyCKRPPgQHKR3s';
  var sheetId = '1xMIn4rjhTDbRBktbyGtYwFe1cH8QO51RewvkRjjS8Cw';
  var range = 'A:C';
  var url = `https://sheets.googleapis.com/v4/spreadsheets/${sheetId}/values/${range}?key=${apiKey}`;

  fetch(url)
    .then(response => response.json())
    .then(data => {
      var lastRow = data.values[data.values.length - 1];
      var status = lastRow[1];

      var overlay = document.getElementById('overlay');
      var alertImage = document.getElementById('alertImage');

      if (status === 'BE') {
        alertImage.src = 'https://infotv.tmskoncz.hu/img/tuzriado-j.png';
        overlay.style.display = 'flex';
      } else if (status === 'TESZT') {
        alertImage.src = 'https://infotv.tmskoncz.hu/img/teszt-tuzriado.png';
        overlay.style.display = 'flex';
      } else {
        overlay.style.display = 'none';
      }
    })
    .catch(error => console.error('Error fetching data:', error));
}

setInterval(checkStatus, 5000);
</script>
</body>
</html>
